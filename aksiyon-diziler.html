<!DOCTYPE html>
<html lang="tr" ng-app="GirisApp">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Aksiyon Dizileri - GLOW</title>
    <link rel="stylesheet" href="assets/css/style.css" />
    <link rel="stylesheet" href="assets/css/film-styles.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="assets/js/app.js"></script>
  </head>
  <body ng-controller="AksiyonDizilerController">
    <div ng-include="'components/header.html'"></div>

    <div class="filmler-container">
      <button class="geri-btn" onclick="window.history.back()" title="Geri D√∂n">
        ‚Üê
      </button>
      <h1 class="filmler-title">üí• Aksiyon Dizileri</h1>

      <!-- Loading -->
      <div class="loading" ng-if="loading">
        <p>Diziler y√ºkleniyor...</p>
      </div>

      <!-- Error -->
      <div class="error" ng-if="error">
        <p>{{ error }}</p>
      </div>

      <!-- Diziler Grid -->
      <div class="filmler-grid" ng-if="!loading && !error">
        <div
          class="film-card"
          ng-repeat="dizi in diziler"
          ng-click="diziDetay(dizi.id)"
        >
          <img
            ng-src="{{ dizi.poster_url }}"
            ng-alt="{{ dizi.dizi_adi }}"
            class="film-poster"
            onerror="this.src='assets/images/logo.jpg'"
          />
          <div class="film-icerik">
            <div class="film-baslik">{{ dizi.dizi_adi }}</div>
            <div class="film-yil">
              {{ dizi.yil }} ‚Ä¢ {{ dizi.sezon_sayisi }} Sezon
            </div>
            <div class="film-imdb">IMDb: {{ dizi.imdb_puani }}</div>
            <div class="film-ozet">
              {{ dizi.aciklama | limitTo: 100 }}{{ dizi.aciklama.length > 100 ?
              '...' : '' }}
            </div>
            <button class="film-btn">Detaylarƒ± G√∂r</button>
          </div>
        </div>
      </div>
    </div>

    <div ng-include="'components/footer.html'"></div>

    <!-- Scroll to Top Button -->
    <button id="scrollTopBtn" title="Yukarƒ± √áƒ±k" ng-click="scrollToTop()">
      ‚Üë
    </button>
  </body>
</html>

<script>
  angular
    .module("GirisApp")
    .controller("AksiyonDizilerController", function ($scope, $http) {
      $scope.loading = true;
      $scope.error = null;
      $scope.diziler = [];

      // Veritabanƒ±ndan dizileri √ßek
      $http
        .get("dizi_api.php?kategori=aksiyon")
        .then(function (response) {
          if (response.data.success) {
            $scope.diziler = response.data.diziler;
          } else {
            $scope.error = response.data.message;
          }
          $scope.loading = false;
        })
        .catch(function (error) {
          $scope.error = "Diziler y√ºklenirken hata olu≈ütu: " + error.statusText;
          $scope.loading = false;
        });

      $scope.diziDetay = function (diziId) {
        window.location.href = "dizi-detay.html?id=" + diziId;
      };

      $scope.scrollToTop = function () {
        window.scrollTo({ top: 0, behavior: "smooth" });
      };
    });
</script>
