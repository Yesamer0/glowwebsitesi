<!DOCTYPE html>
<html lang="tr" ng-app="GirisApp">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Şehir Detayı - GLOW</title>
    <link rel="stylesheet" href="assets/css/style.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.8.2/angular.min.js"></script>
    <script src="assets/js/app.js"></script>
    <style>
      /* Kategori bazlı renk sistemleri */
      .detay-container.avrupa {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95),
          rgba(255, 182, 193, 0.1)
        );
        box-shadow: 0 8px 32px rgba(255, 182, 193, 0.2);
      }

      .detay-container.asya {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95),
          rgba(255, 215, 0, 0.1)
        );
        box-shadow: 0 8px 32px rgba(255, 215, 0, 0.2);
      }

      .detay-container.amerika {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95),
          rgba(255, 69, 0, 0.1)
        );
        box-shadow: 0 8px 32px rgba(255, 69, 0, 0.2);
      }

      .detay-container.afrika {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95),
          rgba(139, 69, 19, 0.1)
        );
        box-shadow: 0 8px 32px rgba(139, 69, 19, 0.2);
      }

      .detay-container.turkiye {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95),
          rgba(255, 0, 0, 0.1)
        );
        box-shadow: 0 8px 32px rgba(255, 0, 0, 0.2);
      }

      .detay-container.deniz {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95),
          rgba(135, 206, 235, 0.1)
        );
        box-shadow: 0 8px 32px rgba(135, 206, 235, 0.2);
      }

      .detay-container.kamp {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95),
          rgba(34, 139, 34, 0.1)
        );
        box-shadow: 0 8px 32px rgba(34, 139, 34, 0.2);
      }

      .detay-container.sehir {
        background: linear-gradient(
          135deg,
          rgba(255, 255, 255, 0.95),
          rgba(147, 112, 219, 0.1)
        );
        box-shadow: 0 8px 32px rgba(147, 112, 219, 0.2);
      }

      .detay-container {
        max-width: 100%;
        margin: 40px auto;
        padding: 32px 40px;
        width: 100%;
        border-radius: 18px;
        backdrop-filter: blur(10px);
      }

      .sehir-header {
        text-align: center;
        margin-bottom: 40px;
        padding-bottom: 30px;
        border-bottom: 2px solid rgba(180, 138, 120, 0.2);
      }

      .sehir-baslik {
        color: #7c5c4a;
        font-size: 2.8rem;
        font-weight: 700;
        margin-bottom: 10px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 15px;
      }

      .sehir-icon {
        font-size: 2.5rem;
      }

      .sehir-ulke {
        color: #b48a78;
        font-size: 1.3rem;
        font-weight: 500;
        margin-bottom: 15px;
      }

      .sehir-aciklama {
        color: #7c5c4a;
        font-size: 1.1rem;
        line-height: 1.7;
        max-width: 800px;
        margin: 0 auto;
      }

      .geri-btn {
        background: linear-gradient(135deg, #e2d9d0, #b48a78);
        color: #7c5c4a;
        border: none;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        font-size: 20px;
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.3s;
        position: absolute;
        top: 20px;
        left: 20px;
      }

      .geri-btn:hover {
        background: linear-gradient(135deg, #b48a78, #e2d9d0);
        color: #fff;
        transform: scale(1.1);
      }

      .bolumler-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
        gap: 30px;
        margin-top: 40px;
      }

      /* Kategori bazlı bölüm kartları */
      .bolum-card.avrupa {
        background: linear-gradient(135deg, #f8e0e1 0%, #ffb6c1 100%);
        box-shadow: 0 6px 20px rgba(255, 182, 193, 0.2);
      }

      .bolum-card.asya {
        background: linear-gradient(135deg, #fff8dc 0%, #ffd700 100%);
        box-shadow: 0 6px 20px rgba(255, 215, 0, 0.2);
      }

      .bolum-card.amerika {
        background: linear-gradient(135deg, #ffe4e1 0%, #ff4500 100%);
        box-shadow: 0 6px 20px rgba(255, 69, 0, 0.2);
      }

      .bolum-card.afrika {
        background: linear-gradient(135deg, #f5f5dc 0%, #8b4513 100%);
        box-shadow: 0 6px 20px rgba(139, 69, 19, 0.2);
      }

      .bolum-card.turkiye {
        background: linear-gradient(135deg, #ffe4e1 0%, #ff0000 100%);
        box-shadow: 0 6px 20px rgba(255, 0, 0, 0.2);
      }

      .bolum-card.deniz {
        background: linear-gradient(135deg, #e0f6ff 0%, #87ceeb 100%);
        box-shadow: 0 6px 20px rgba(135, 206, 235, 0.2);
      }

      .bolum-card.kamp {
        background: linear-gradient(135deg, #f0fff0 0%, #228b22 100%);
        box-shadow: 0 6px 20px rgba(34, 139, 34, 0.2);
      }

      .bolum-card.sehir {
        background: linear-gradient(135deg, #f8f0ff 0%, #9370db 100%);
        box-shadow: 0 6px 20px rgba(147, 112, 219, 0.2);
      }

      .bolum-card {
        border-radius: 16px;
        padding: 30px;
        transition: all 0.3s ease;
      }

      .bolum-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 30px rgba(180, 138, 120, 0.2);
      }

      .bolum-baslik {
        color: #7c5c4a;
        font-size: 1.5rem;
        font-weight: 700;
        margin-bottom: 20px;
        display: flex;
        align-items: center;
        gap: 10px;
        padding-bottom: 10px;
        border-bottom: 2px solid rgba(180, 138, 120, 0.3);
      }

      .bolum-icon {
        font-size: 1.3rem;
      }

      .bolum-icerik {
        color: #7c5c4a;
        font-size: 1rem;
        line-height: 1.7;
        margin-bottom: 20px;
      }

      .liste-item {
        background: rgba(255, 255, 255, 0.7);
        padding: 12px 16px;
        margin-bottom: 10px;
        border-radius: 8px;
        border-left: 4px solid #b48a78;
        transition: all 0.3s;
      }

      .liste-item:hover {
        background: rgba(255, 255, 255, 0.9);
        transform: translateX(5px);
      }

      .tarih-bolum {
        grid-column: 1 / -1;
      }

      .tarih-icerik {
        font-size: 1.1rem;
        line-height: 1.8;
        text-align: justify;
      }

      /* Şehir Fotoğraf Slider CSS */
      .slider-outer-container {
        background: transparent;
        padding: 30px;
        border-radius: 16px;
        margin-bottom: 30px;
      }

      .slider-outer-container .bolum-baslik {
        margin-bottom: 20px;
        text-align: center;
      }

      .sehir-slider-container {
        position: relative;
        width: 100%;
        height: 500px;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 6px 20px rgba(180, 138, 120, 0.2);
      }

      .sehir-slider {
        display: flex;
        width: 100%;
        height: 100%;
        transition: transform 0.5s ease;
      }

      .sehir-slide {
        min-width: 100%;
        height: 100%;
        position: relative;
      }

      .sehir-slide img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .sehir-slide-overlay {
        position: absolute;
        bottom: 0;
        left: 0;
        right: 0;
        background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
        color: white;
        padding: 20px;
        text-align: center;
      }

      .sehir-slide-title {
        font-size: 1.2rem;
        font-weight: 600;
        margin-bottom: 5px;
      }

      .sehir-slide-desc {
        font-size: 0.9rem;
        opacity: 0.9;
      }

      .slider-nav {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        background: none;
        border: none;
        font-size: 60px;
        font-weight: bold;
        color: rgba(255, 255, 255, 0.9);
        cursor: pointer;
        z-index: 10;
        text-shadow: 2px 2px 15px rgba(0, 0, 0, 0.9);
      }

      .slider-nav:hover {
        color: rgba(255, 255, 255, 1);
        text-shadow: 3px 3px 20px rgba(0, 0, 0, 1);
      }

      .slider-nav.prev {
        left: 10px;
      }

      .slider-nav.next {
        right: 10px;
      }

      .slider-dots {
        position: absolute;
        bottom: 10px;
        left: 50%;
        transform: translateX(-50%);
        display: flex;
        gap: 8px;
        z-index: 10;
      }

      .slider-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: rgba(255, 255, 255, 0.5);
        cursor: pointer;
        transition: all 0.3s;
      }

      .slider-dot.active {
        background: rgba(255, 255, 255, 1);
        transform: scale(1.2);
      }

      @media (max-width: 768px) {
        .detay-container {
          margin: 20px;
          padding: 20px;
          max-width: 100%;
        }

        .sehir-baslik {
          font-size: 2.2rem;
          flex-direction: column;
          gap: 10px;
        }

        .bolumler-grid {
          grid-template-columns: 1fr;
          gap: 20px;
        }

        .geri-btn {
          top: 15px;
          left: 15px;
          width: 45px;
          height: 45px;
          font-size: 18px;
        }

        .sehir-slider-container {
          height: 350px;
        }

        .slider-nav {
          font-size: 50px;
        }

        .sehir-slide-overlay {
          padding: 15px;
        }

        .sehir-slide-title {
          font-size: 1rem;
        }

        .sehir-slide-desc {
          font-size: 0.8rem;
        }
      }
    </style>
  </head>
  <body>
    <ng-include src="'components/header.html'"></ng-include>

    <main class="main-content">
      <div
        class="detay-container"
        ng-class="kategoriClass"
        ng-controller="SehirDetayController"
      >
        <button
          class="geri-btn"
          onclick="window.history.back()"
          title="Geri Dön"
        >
          ←
        </button>

        <div class="sehir-header">
          <h1 class="sehir-baslik">
            <span class="sehir-icon">{{sehir.icon}}</span>
            {{sehir.ad}}
          </h1>
          <p class="sehir-ulke">{{sehir.ulke}}</p>
          <p class="sehir-aciklama">{{sehir.kisaAciklama}}</p>
        </div>

        <div class="bolumler-grid">
          <!-- Tarih Bölümü -->
          <div class="bolum-card tarih-bolum" ng-class="kategoriClass">
            <h2 class="bolum-baslik">
              <span class="bolum-icon">📚</span>
              Tarihi Bilgiler
            </h2>
            <div class="tarih-icerik">{{sehir.tarih}}</div>
          </div>

          <!-- Görülecek Yerler -->
          <div class="bolum-card" ng-class="kategoriClass">
            <h2 class="bolum-baslik">
              <span class="bolum-icon">🏛️</span>
              Görülecek Yerler
            </h2>
            <div class="liste-item" ng-repeat="yer in sehir.gorulecekYerler">
              {{yer}}
            </div>
          </div>

          <!-- Etkinlikler -->
          <div class="bolum-card" ng-class="kategoriClass">
            <h2 class="bolum-baslik">
              <span class="bolum-icon">🎉</span>
              Etkinlikler
            </h2>
            <div class="liste-item" ng-repeat="etkinlik in sehir.etkinlikler">
              {{etkinlik}}
            </div>
          </div>

          <!-- Restoranlar -->
          <div class="bolum-card" ng-class="kategoriClass">
            <h2 class="bolum-baslik">
              <span class="bolum-icon">🍽️</span>
              Restoranlar
            </h2>
            <div class="liste-item" ng-repeat="restoran in sehir.restoranlar">
              {{restoran}}
            </div>
          </div>

          <!-- Şehir Fotoğraf Slider - Sadece İzmir için aktif -->
          <div
            class="slider-outer-container"
            ng-show="sehir.ad.toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g, '').includes('izmir')"
          >
            <h2 class="bolum-baslik">
              <span class="bolum-icon">📸</span>
              {{sehir.ad}} Fotoğrafları
            </h2>
            <div class="sehir-slider-container">
              <div
                class="sehir-slider"
                ng-style="{'transform': 'translateX(-' + (currentSlide * 100) + '%)'}"
              >
                <div class="sehir-slide" ng-repeat="foto in sehirFotograflari">
                  <img ng-src="{{foto.url}}" alt="{{foto.baslik}}" />
                  <div class="sehir-slide-overlay">
                    <div class="sehir-slide-title">{{foto.baslik}}</div>
                    <div class="sehir-slide-desc">{{foto.aciklama}}</div>
                  </div>
                </div>
              </div>

              <!-- Navigation Buttons -->
              <span class="slider-nav prev" ng-click="prevSlide()">ᐊ</span>
              <span class="slider-nav next" ng-click="nextSlide()">ᐅ</span>

              <!-- Dots -->
              <div class="slider-dots">
                <div
                  class="slider-dot"
                  ng-repeat="(index, foto) in sehirFotograflari"
                  ng-class="{'active': index === currentSlide}"
                  ng-click="goToSlide(index)"
                ></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <ng-include src="'components/footer.html'"></ng-include>

    <script>
      angular
        .module("GirisApp")
        .controller("SehirDetayController", function ($scope) {
          $scope.kullanici = JSON.parse(
            localStorage.getItem("girisYapan") || "null"
          );

          // Slider değişkenleri
          $scope.currentSlide = 0;
          $scope.sehirFotograflari = [];

          // Slider fonksiyonları - Sonsuz döngü
          $scope.nextSlide = function () {
            $scope.currentSlide++;
            if ($scope.currentSlide >= $scope.sehirFotograflari.length) {
              $scope.currentSlide = 0; // Başa dön
            }
          };

          $scope.prevSlide = function () {
            $scope.currentSlide--;
            if ($scope.currentSlide < 0) {
              $scope.currentSlide = $scope.sehirFotograflari.length - 1; // Sona git
            }
          };

          $scope.goToSlide = function (index) {
            $scope.currentSlide = index;
          };

          // Şehir fotoğrafları belirleme fonksiyonu - Sadece İzmir için
          $scope.getSehirFotograflari = function (sehirAdi) {
            var sehirAdiLower = sehirAdi.toLowerCase();

            // Debug: Şehir adını kontrol et
            console.log("getSehirFotograflari çağrıldı, şehir adı:", sehirAdi);
            console.log("Şehir adı lowercase:", sehirAdiLower);
            console.log("izmir içeriyor mu:", sehirAdiLower.includes("izmir"));

            // Sadece İzmir için fotoğraflar - Türkçe karakter sorunu çözümü
            var normalizedSehirAdi = sehirAdiLower
              .normalize("NFD")
              .replace(/[\u0300-\u036f]/g, "");
            console.log(
              "Normalized şehir adı:",
              '"' + normalizedSehirAdi + '"'
            );

            if (normalizedSehirAdi.includes("izmir")) {
              console.log("İzmir fotoğrafları döndürülüyor");
              return [
                {
                  url: "https://blog.corendonairlines.com/wp-content/uploads/2024/04/makale-kapak-izmir.jpg",
                  baslik: "İzmir Manzarası",
                  aciklama: "Güzel İzmir şehir manzarası",
                },
                {
                  url: "https://www.izmir.art/imgServ/img/uploads/image-bdf5ca63f85181c17d9f7909d2cf6e467ad67483.png",
                  baslik: "Konak Meydanı",
                  aciklama: "Şehrin kalbi ve saat kulesi",
                },
                {
                  url: "https://i.pinimg.com/736x/f3/11/9a/f3119a881c3e8b9a70cfe7cbccac5366.jpg",
                  baslik: "Kordon Sahili",
                  aciklama: "Ege Denizi manzaralı sahil yolu",
                },
                {
                  url: "https://www.izmirdergisi.com/templates/yootheme/cache/alsancak-1-95d082c0.jpeg",
                  baslik: "Alsancak Mahallesi",
                  aciklama: "Modern yaşam ve gece hayatı",
                },
                {
                  url: "https://www.izmir.art/imgServ/img/uploads/image-242c0f297b27293a384cc3e3fe60807351bffb87.png",
                  baslik: "Kadifekale",
                  aciklama: "Tarihi kale ve şehir manzarası",
                },
              ];
            }

            console.log("İzmir değil, boş array döndürülüyor");
            // Diğer şehirler için boş array döndür (slider gizlenecek)
            return [];
          };

          // LocalStorage'dan seçilen şehri al
          var seciliSehirStr = localStorage.getItem("seciliSehir");
          if (seciliSehirStr) {
            $scope.sehir = JSON.parse(seciliSehirStr);

            // Şehir fotoğraflarını yükle
            $scope.sehirFotograflari = $scope.getSehirFotograflari(
              $scope.sehir.ad
            );

            // Debug: Fotoğrafların yüklenip yüklenmediğini kontrol et
            console.log("Şehir adı:", $scope.sehir.ad);
            console.log("Fotoğraflar:", $scope.sehirFotograflari);
            console.log(
              "Slider görünür mü:",
              $scope.sehir.ad.toLowerCase().includes("izmir")
            );

            // Kategori belirleme mantığı
            $scope.kategoriClass = "avrupa"; // Varsayılan

            // Şehir adına göre kategori belirleme
            var sehirAdi = $scope.sehir.ad.toLowerCase();

            // Avrupa şehirleri
            if (
              sehirAdi.includes("paris") ||
              sehirAdi.includes("roma") ||
              sehirAdi.includes("barcelona") ||
              sehirAdi.includes("amsterdam") ||
              sehirAdi.includes("prag") ||
              sehirAdi.includes("viyana") ||
              sehirAdi.includes("londra") ||
              sehirAdi.includes("berlin") ||
              sehirAdi.includes("budapeşte") ||
              sehirAdi.includes("istanbul")
            ) {
              $scope.kategoriClass = "avrupa";
            }
            // Asya şehirleri
            else if (
              sehirAdi.includes("tokyo") ||
              sehirAdi.includes("seul") ||
              sehirAdi.includes("bangkok") ||
              sehirAdi.includes("singapore") ||
              sehirAdi.includes("hong kong") ||
              sehirAdi.includes("beijing") ||
              sehirAdi.includes("pekin") ||
              sehirAdi.includes("shanghai") ||
              sehirAdi.includes("delhi") ||
              sehirAdi.includes("bakü") ||
              sehirAdi.includes("dubai") ||
              sehirAdi.includes("mumbai")
            ) {
              $scope.kategoriClass = "asya";
            }
            // Amerika şehirleri
            else if (
              sehirAdi.includes("new york") ||
              sehirAdi.includes("los angeles") ||
              sehirAdi.includes("chicago") ||
              sehirAdi.includes("miami") ||
              sehirAdi.includes("san francisco") ||
              sehirAdi.includes("las vegas") ||
              sehirAdi.includes("washington") ||
              sehirAdi.includes("boston") ||
              sehirAdi.includes("new orleans") ||
              sehirAdi.includes("seattle")
            ) {
              $scope.kategoriClass = "amerika";
            }
            // Afrika şehirleri
            else if (
              sehirAdi.includes("kahire") ||
              sehirAdi.includes("cape town") ||
              sehirAdi.includes("marakeş") ||
              sehirAdi.includes("nairobi") ||
              sehirAdi.includes("lagos") ||
              sehirAdi.includes("johannesburg") ||
              sehirAdi.includes("khartum") ||
              sehirAdi.includes("dakar") ||
              sehirAdi.includes("addis ababa") ||
              sehirAdi.includes("tunus")
            ) {
              $scope.kategoriClass = "afrika";
            }
            // Türkiye şehirleri
            else if (
              sehirAdi.includes("istanbul") ||
              sehirAdi.includes("ankara") ||
              sehirAdi.includes("izmir") ||
              sehirAdi.includes("antalya") ||
              sehirAdi.includes("bursa") ||
              sehirAdi.includes("konya") ||
              sehirAdi.includes("trabzon") ||
              sehirAdi.includes("gaziantep") ||
              sehirAdi.includes("kayseri") ||
              sehirAdi.includes("eskişehir")
            ) {
              $scope.kategoriClass = "turkiye";
            }
            // Deniz destinasyonları
            else if (
              sehirAdi.includes("maldives") ||
              sehirAdi.includes("santorini") ||
              sehirAdi.includes("bora bora") ||
              sehirAdi.includes("amalfi") ||
              sehirAdi.includes("seychelles") ||
              sehirAdi.includes("barrier reef") ||
              sehirAdi.includes("dubrovnik") ||
              sehirAdi.includes("maui") ||
              sehirAdi.includes("cinque terre") ||
              sehirAdi.includes("phi phi")
            ) {
              $scope.kategoriClass = "deniz";
            }
            // Kamp ve doğa destinasyonları
            else if (
              sehirAdi.includes("yellowstone") ||
              sehirAdi.includes("banff") ||
              sehirAdi.includes("patagonia") ||
              sehirAdi.includes("swiss alps") ||
              sehirAdi.includes("new zealand") ||
              sehirAdi.includes("iceland") ||
              sehirAdi.includes("norwegian fjords") ||
              sehirAdi.includes("amazon") ||
              sehirAdi.includes("serengeti") ||
              sehirAdi.includes("galapagos")
            ) {
              $scope.kategoriClass = "kamp";
            }
            // Şehir turları
            else if (
              sehirAdi.includes("walking tour") ||
              sehirAdi.includes("historical tour") ||
              sehirAdi.includes("urban adventure") ||
              sehirAdi.includes("city tour") ||
              sehirAdi.includes("royal tour") ||
              sehirAdi.includes("cultural tour") ||
              sehirAdi.includes("heritage tour") ||
              sehirAdi.includes("canal tour") ||
              sehirAdi.includes("castle tour") ||
              sehirAdi.includes("imperial tour")
            ) {
              $scope.kategoriClass = "sehir";
            }
          } else {
            // Eğer şehir bilgisi yoksa ana sayfaya yönlendir
            window.location.href = "avrupa-seyahatleri.html";
          }
        });
    </script>
  </body>
</html>
